<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
        <script src="http://draw2d.org/draw2d_touch/jsdoc_5/draw2d/lib/jquery-1.10.2.min.js"></script>
        <script src="http://draw2d.org/draw2d_touch/jsdoc_5/draw2d/lib/jquery.autoresize.js"></script>
        <script src="http://draw2d.org/draw2d_touch/jsdoc_5/draw2d/lib/jquery-touch_punch.js"></script>
        <script src="http://draw2d.org/draw2d_touch/jsdoc_5/draw2d/lib/jquery.contextmenu.js"></script>
        <script src="http://draw2d.org/draw2d_touch/jsdoc_5/draw2d/lib/shifty.js"></script>
        <script src="http://draw2d.org/draw2d_touch/jsdoc_5/draw2d/lib/raphael.js"></script>
        <script src="http://draw2d.org/draw2d_touch/jsdoc_5/draw2d/lib/rgbcolor.js"></script>
        <script src="http://draw2d.org/draw2d_touch/jsdoc_5/draw2d/lib/canvg.js"></script>
        <script src="http://draw2d.org/draw2d_touch/jsdoc_5/draw2d/lib/Class.js"></script>
        <script src="http://draw2d.org/draw2d_touch/jsdoc_5/draw2d/lib/json2.js"></script>
        <script src="http://draw2d.org/draw2d_touch/jsdoc_5/draw2d/lib/pathfinding-browser.min.js"></script>
        <script src="http://draw2d.org/draw2d_touch/jsdoc_5/draw2d/src/draw2d.js"></script>
        <!-- jQuery UI -->
		<script src="http://code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
		<link rel="stylesheet" href="https://code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
		
		
		<script src="js/SmoGui.js"></script>
		<script src="js/shapes.js"></script>
		<script src="js/jsonData.json"></script>
		
		<!-- ContextMenu -->
		<link rel="stylesheet" href="css/jquery.contextMenu.css">
		<script src="js/contextMenu/jquery.ui.position.js"></script>
		<script src="js/contextMenu/jquery.contextMenu.js"></script>
		
		<script src="js/jsonData.json"></script>
        
        <script>			
			var app;
			$(document).ready(function() {
				app = new smoGui.Application("canvas");
				app.canvas.setDimension({width: 1000, height: 430});
				app.canvas.loadFromJson(jsonData);
				var jsonObj = app.canvas.getJson();
				for (var figKey in jsonObj) {
					smoGui.addComponentModal(app.canvas.getFigure(jsonObj[figKey].id));
				}
				
				$('#components ul>li').each(function(index, element){
					$(element)
					.draggable({
								appendTo: "body",
								helper: "clone",
								stop: function(event, ui) {
									var myShape;
									var cloneOffset = ui.helper.offset();
									var id = $(this).context.id;
									if (id == 'MyRectangle') {
										myShape = new MyRectangle();
									} else if (id == 'MyCircle') {
										myShape = new MyCircle();
									}
									app.canvas.add(myShape, cloneOffset.left - app.canvas.getAbsoluteX(), 
									cloneOffset.top - app.canvas.getAbsoluteY());
									smoGui.addComponentModal(myShape);
								}
					});
				});
			});
        </script>
</head>
<body id="container">
	<div id="canvas" style="border: 3px solid grey;"></div>
	<div id="components" style="width: 200px; height: 650px; position: absolute; top: 10px; left: 1050px; border: 3px solid green; overflow-y: auto;">
		<ul>
			<li id="MyRectangle">MyRectangle</li>
			<li id="MyCircle">MyCircle</li>
		</ul>
	</div>
	<div id="console" style="width: 1000px; height: 200px; position: absolute; top: 460px; border: 3px solid blue; overflow-y: auto;">
		<div id="console-header" style="margin-bottom: 5px;">
			Console 
			<span><button onclick="app.console.clear()">Clear</button></span>
			<span><button onclick="app.canvas.updateJson()">Update Json</button></span></div>
		<div id="events"></div>
	</div>
	<div id="component-modals-container"></div>
</body>
</html>
